<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance and Exam Management System</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    color: #fff;
    background-color: #0d1b2a;
  }

  /* Background before login (bubbles) */
  body.login-bg {
    background-color: #0d1b2a;
  }

  /* Campus background after login */
  body.dashboard-bg {
    background: url('https://matilitechnical.ac.ke/images/campus-view.jpg') no-repeat center center fixed;
    background-size: cover;
    overflow: auto;
  }

  /* Dashboard header */
  #dashboard-header {
    position: relative;
    display: flex;
    align-items: center;          /* Vertical centering */
    justify-content: flex-start;  /* Logo on left */
    padding: 15px 20px;
    background-color: rgba(0,0,0,0.6);
    border-bottom: 2px solid #00ffff;
    box-shadow: 0 0 10px #00ffff;
  }

  #dashboard-title {
    color: white;
    font-weight: bold;            /* Bold title */
    font-size: 24px;
    text-align: center;
    position: absolute;           /* Float independently */
    left: 50%;                    /* Horizontal center */
    top: 50%;                     /* Vertical center */
    transform: translate(-50%, -50%); /* Perfect center in both axes */
  }

  img#logo {
    width: 120px;
    height: auto;
    z-index: 1;
  }

  /* Buttons */
  .btn {
    padding: 8px 15px;
    background-color: #004d99;
    color: white;
    border: 2px solid #00ffff;
    border-radius: 5px;
    cursor: pointer;
    margin: 5px 0;
    box-shadow: 0 0 10px #00ffff;
    transition: 0.3s;
  }
  .btn:hover {
    background-color: #003366;
    box-shadow: 0 0 20px #00ffff;
  }

  /* Input fields */
  input[type="text"], input[type="number"], select {
    padding: 5px;
    margin: 5px 0;
    border: 2px solid #00ffff;
    border-radius: 5px;
    outline: none;
  }
  input[type="text"]:focus, input[type="number"]:focus, select:focus {
    border-color: #00ffff;
    box-shadow: 0 0 10px #00ffff;
  }

  /* Forms and sections */
  #login-section, #signup-section {
    padding: 20px;
    max-width: 400px;
    margin: 50px auto;
    background-color: rgba(0,0,0,0.7);
    border-radius: 10px;
    box-shadow: 0 0 15px #00ffff;
  }

  #dashboard-section, #users-section, #attendance-section, #exam-section {
    padding: 20px;
    max-width: 1000px;
    margin: 20px auto;
    background-color: rgba(0,0,0,0.6);
    border-radius: 10px;
    box-shadow: 0 0 15px #00ffff;
  }

  /* Tables */
  table {
    width: 100%;
    border-collapse: collapse;
    margin: 10px 0;
    background-color: rgba(0,0,0,0.8);
  }
  th, td {
    border: 2px solid #00ffff;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #004d99;
    cursor: pointer;
  }

  /* Admin side menu */
  #admin-menu {
    display: flex;
    flex-direction: column;
    width: 200px;
    float: left;
    margin-right: 20px;
  }
  #admin-menu button {
    margin-bottom: 10px;
    width: 100%;
  }

  /* Content area */
  #admin-content {
    margin-left: 220px;
  }

  h2, h3 {
    color: #00ffff;
  }

  /* Particle canvas before login */
  canvas#particle-canvas {
    position: fixed;
    top:0; left:0;
    width:100%;
    height:100%;
    z-index:-1;
  }

</style>
</head>
<body class="login-bg">

<!-- Particle Canvas (before login) -->
<canvas id="particle-canvas"></canvas>

<!-- Dashboard Header -->
<div id="dashboard-header">
  <img id="logo" src="https://matilitechnical.ac.ke/images/logo.png" alt="Matili TTI Logo">
  <h1 id="dashboard-title">ATTENDANCE AND EXAM MANAGEMENT SYSTEM</h1>
</div>

<!-- Login Section -->
<div id="login-section">
  <h2>Login</h2>
  <input type="text" id="login-username" placeholder="Username"><br>
  <input type="text" id="login-email" placeholder="Email"><br>
  <button class="btn" onclick="login()">Login</button>
  <p>Don't have an account? <button class="btn" onclick="showSignup()">Sign Up</button></p>
</div>

<!-- Signup Section -->
<div id="signup-section" style="display:none;">
  <h2>Sign Up</h2>
  <input type="text" id="signup-username" placeholder="Username"><br>
  <input type="text" id="signup-email" placeholder="Email"><br>
  <select id="signup-role">
    <option value="Student">Student</option>
    <option value="Teacher">Teacher</option>
    <option value="Admin">Admin</option>
  </select><br>
  <input type="text" id="signup-department" placeholder="Department"><br>
  <button class="btn" onclick="signup()">Sign Up</button>
</div>

<!-- Dashboard Section -->
<div id="dashboard-section" style="display:none;">
  <button class="btn" onclick="logout()">Logout</button>

  <!-- Admin Side Menu -->
  <div id="admin-menu" style="display:none;">
    <button class="btn" onclick="showAdminContent('students')">Students</button>
    <button class="btn" onclick="showAdminContent('teachers')">Teachers</button>
    <button class="btn" onclick="showAdminContent('units')">Units</button>
    <button class="btn" onclick="showAdminContent('results')">Results</button>
  </div>

  <!-- Admin Content Area -->
  <div id="admin-content"></div>

  <!-- Teacher Attendance Section -->
  <div id="attendance-section" style="display:none;">
    <h3>Mark Attendance</h3>
    <div id="attendance-form-container"></div>
    <table id="attendance-table">
      <thead><tr><th>Date</th><th>Unit</th><th>Student</th><th>Status</th></tr></thead>
      <tbody></tbody>
    </table>
    <button class="btn" onclick="markAttendance()">Mark Attendance</button>
  </div>

  <!-- Teacher Exam Section -->
  <div id="exam-section" style="display:none;">
    <h3>Exam Marks</h3>
    <div id="exam-form-container"></div>
    <table id="exam-table">
      <thead><tr><th>Exam</th><th>Unit</th><th>Student</th><th>Marks</th><th>Total</th></tr></thead>
      <tbody></tbody>
    </table>
    <button class="btn" onclick="recordExam()">Save Exams</button>
  </div>

</div>

<script>
let users=[], units=[], attendanceRecords=[], examRecords=[], currentUser=null;

function showSignup(){
  document.getElementById('login-section').style.display='none';
  document.getElementById('signup-section').style.display='block';
}

function signup(){
  let u=document.getElementById('signup-username').value;
  let e=document.getElementById('signup-email').value;
  let r=document.getElementById('signup-role').value;
  let d=document.getElementById('signup-department').value;
  if(!u || !e){ alert("Username and Email required!"); return; }
  users.push({username:u,email:e,role:r,department:d});
  alert('Signup success! Please login.');
  document.getElementById('signup-username').value='';
  document.getElementById('signup-email').value='';
  document.getElementById('signup-section').style.display='none';
  document.getElementById('login-section').style.display='block';
}

function login(){
  let u=document.getElementById('login-username').value;
  let e=document.getElementById('login-email').value;
  currentUser=users.find(x=>x.username===u && x.email===e);
  if(currentUser){
    document.body.className='dashboard-bg';
    document.getElementById('login-section').style.display='none';
    document.getElementById('signup-section').style.display='none';
    document.getElementById('dashboard-section').style.display='block';
    if(currentUser.role==='Admin'){
      document.getElementById('admin-menu').style.display='flex';
      showAdminContent('students');
    } else if(currentUser.role==='Teacher'){
      document.getElementById('attendance-section').style.display='block';
      document.getElementById('exam-section').style.display='block';
    }
    initDashboard();
  } else {
    alert('Invalid credentials!');
  }
}

function logout(){
  currentUser=null;
  document.body.className='login-bg';
  document.getElementById('dashboard-section').style.display='none';
  document.getElementById('login-section').style.display='block';
}

function showAdminContent(section){
  let content=document.getElementById('admin-content');
  content.innerHTML='';
  if(section==='students'){
    content.innerHTML='<h3>Students</h3>';
    users.filter(u=>u.role==='Student').forEach(s=>content.innerHTML+=`<p>${s.username} (${s.department})</p>`);
  } else if(section==='teachers'){
    content.innerHTML='<h3>Teachers</h3>';
    users.filter(u=>u.role==='Teacher').forEach(t=>content.innerHTML+=`<p>${t.username} (${t.department})</p>`);
  } else if(section==='units'){
    content.innerHTML='<h3>Units</h3>';
    units.forEach(u=>content.innerHTML+=`<p>${u}</p>`);
  } else if(section==='results'){
    content.innerHTML='<h3>Exam Results</h3>';
    examRecords.forEach(r=>content.innerHTML+=`<p>${r.student} - ${r.unit}: ${r.marks}/${r.total}</p>`);
  }
}

function initDashboard(){}

function markAttendance(){ alert('Attendance marked (demo).'); }

function recordExam(){ alert('Exams recorded (demo).'); }

const canvas=document.getElementById('particle-canvas');
const ctx=canvas.getContext('2d');
let particles=[];
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

function Particle(){
  this.x=Math.random()*canvas.width;
  this.y=Math.random()*canvas.height;
  this.r=Math.random()*3+1;
  this.dx=(Math.random()-0.5)*1;
  this.dy=(Math.random()-0.5)*1;
  this.draw=function(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
    ctx.fillStyle='#00ffff';
    ctx.fill();
  }
  this.update=function(){
    if(this.x<0||this.x>canvas.width)this.dx*=-1;
    if(this.y<0||this.y>canvas.height)this.dy*=-1;
    this.x+=this.dx; this.y+=this.dy;
    this.draw();
  }
}
for(let i=0;i<100;i++)particles.push(new Particle());
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>p.update());
  requestAnimationFrame(animate);
}
animate();
window.onresize=function(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; };
</script>

</body>
</html>
